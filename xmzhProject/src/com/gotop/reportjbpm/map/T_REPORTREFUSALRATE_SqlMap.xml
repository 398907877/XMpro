<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="T_REPORTREFUSALRATE_SqlMap">
 <resultMap id="ReportRefusalrate" class="com.gotop.reportjbpm.model.ReportRefusalrate" >
    <!--Bean方式返回全表-->
    <result column="REPORTTIMESTRAT" property="reporttimeStrat" jdbcType="VARCHAR" />
    <result column="REPORTTIMEEND" property="reporttimeEnd" jdbcType="VARCHAR" />
    <result column="ONECATEGORY" property="oneCategory" jdbcType="VARCHAR" />
    <result column="LOANCATEGORY" property="loanCategory" jdbcType="VARCHAR" />
    <result column="LOAN" property="loan" jdbcType="VARCHAR" />
    <result column="AREASUBBRANCH" property="areasubbranch" jdbcType="VARCHAR" />
    <result column="SECONDARYSUBBRANCH" property="secondarysubbranch" jdbcType="VARCHAR" />
    <result column="EA_NUMBER" property="EA_number" jdbcType="VARCHAR" />
    <result column="REJECTION_NUMBER" property="rejection_number" jdbcType="VARCHAR" />
    <result column="REFUSALRATE" property="refusalrate" jdbcType="VARCHAR" />
    
  </resultMap>
	
	<!-- 查询拒贷信息 -->
	<select id="queryReportRefusalRate" parameterClass="java.util.HashMap" resultMap="ReportRefusalrate">
		select Y.REPORTTIMESTRAT,Y.REPORTTIMEEND,Y.ONECATEGORY,ORGNAME,EMPNAME,Y.LOANCATEGORY,ROLENAME,POSINAME,EMPSTATUS,GENDER,MOBILENO
  from OM_EMPORG      A,
       OM_POSITION    P,
       OM_EMPPOSITION  N,
       OM_EMPLOYEE     Y,
       OM_ORGANIZATION G,
       AC_ROLE         R,
       ABF_T_YGFJXXB   B,
       AC_OPERATOR     O,
       AC_OPERATORROLE E
 where A.EMPID = Y.EMPID
   AND A.ORGID = G.ORGID
   AND Y.USERID = O.USERID
   AND O.OPERATORID = E.OPERATORID
   AND E.ROLEID = R.ROLEID
   AND Y.EMPID = B.EMPID
   AND N.POSITIONID = P.POSITIONID
   AND N.EMPID = Y.EMPID
       <isNotNull prepend="and" property="reporttimeStrat" >
           	 <![CDATA[
            	v.reporttime>='$reporttimeStrat$'
               ]]>
      		</isNotNull>
           <isNotNull prepend="and" property="reporttimeEnd" >
           	<![CDATA[
            	v.reporttime<='$reporttimeEnd$'
               ]]>
      		</isNotNull>
      <isNotNull prepend="and" property="oneCategory" >
           	 v.onecategory in(select dic.dictname from eos_dict_entry dic where dic.dicttypeid='PROCESS_onecategory' 
           	 and dic.dictid in($oneCategory$))
      		</isNotNull>
      		 <isNotNull prepend="and" property="loanCategory" >
           	 v.onecategory in(select dic.dictname from eos_dict_entry dic where dic.dicttypeid='PROCESS_credit_type' 
           	 and dic.dictid in($loanCategory$))
      		</isNotNull>
     
	</select>
	
</sqlMap>